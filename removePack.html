<!doctype html>
<html>

<head>
	<meta http-equiv="pragma" content="no-cache" />
	<meta http-equiv="cache-control" content="no-cache" />
	<meta http-equiv="expires" content="0" />
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
	<title>Choose a Pack</title>
	<script src="assets/jquery-1.11.0.min.js"></script>
	<script src="assets/jquery.mobile-1.4.2.min.js"></script>
	<link rel="stylesheet" href="assets/jquery.mobile-1.4.2.min.css">
</head>

<body>

	<script type="application/javascript">
		$(document).ready(function () {
			makePacks();
			$("#packContainer").trigger('create').enhanceWithin();
		});
		/*********************************************************
		 * makePacks()
		 * Generates the HTML for the user interface for this page.
		 ***********************************************************/
		function makePacks() {
			var jsonObject = JSON.parse(localStorage['packList']);
			for (var key in jsonObject['packs']) {
				{
					$("#packContainer").append('<button onclick="removePack(' + jsonObject["packs"][key].id + ')">' + jsonObject["packs"][key].userName + '</button>').enhanceWithin();
				}
			}
		}



		function removePack(id) {
			var confirm = window.confirm("Are you sure you want to delete this pack?");
			if (confirm) {
				var jsonObject = JSON.parse(localStorage["packList"]); // take the packList out for editing
				for (var key in jsonObject["packs"]) {

					if (jsonObject["packs"][key].id == id) {
						if (localStorage["currentPack"] == jsonObject["packs"][key].systemName) {
							localStorage["currentPack"] = jsonObject.defaultPack;
						} // catch if the user is deleting the current pack
						localStorage.removeItem(jsonObject["packs"][key].systemName); // remove the pack from storage
						jsonObject["packs"].splice(key, 1); // remove the pack from packList
						localStorage["packList"] = JSON.stringify(jsonObject);
						window.location = "removePack.html"; //refresh the removePack page
					}
				}
			}
		}
	</script>
	<div id="packContainer">
		<h3 style="text-align: center; text-decoration: underline">Choose a Pack to Remove:</h3>
	</div>
	<input id="finishedButton" type="button" value="Finished" onclick="window.location='index.html'">
</body>

</html>